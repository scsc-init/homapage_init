# `~/docs/user.md` 페이지에 대한 comment

**작성자:** 강명석  
**최신개정일:** 2025-05-01  

일단 앞서 말씀드렸듯, 잘 하셨습니다. ~~동아리에서 DB로 열 손가락 안에는 들 것 같습니다.~~  
전공 테이블을 따로 빼둔 것도 SQL 면에서 합리적이고, SQL 형식이었던 것도 SQLite 형식으로 잘 바꾼 것 같습니다.  
전공 DB 유효성 검사를 하드코딩으로 하는 것도 확실히 별로입니다. 여유가 될 때 admin이 수정할 수 있게 하는 쪽으로 개발하는 것이 적절해 보여요.

---

## 수정점

### User DB

| 항목            | 수정 제안                                                                 |
|-----------------|--------------------------------------------------------------------------|
| `role`          | 앞서 논의한 회원 단계에 맞춰 enum 값을 `'user'`, `'executive'/'admin'`, `'president'` 로 변경하는 것이 더 직관적일 것 같습니다. |
| `oauth_id`      | 프론트 단에서 NextAuth로 처리할 수 있으므로 제거하는 것이 적절합니다. |
| `login_provider`| 만약 OAuth를 사용할 예정이라면, Google OAuth만을 단일 사용할 것이므로 제거하는 것이 적절합니다.  |
| `id`            | `AUTOINCREMENT` 사용이 부적절할 수 있습니다. → email의 해시값 또는 uuid 대체 가능 (5월 12일 회의에서 논의 예정) |

간단하게 필드만 이렇게 업데이트 해주시면 감사하겠습니다.

---

### API Requests Detail

- `/api/users`  
  → request body에 `email`, `name`, `phone`, `student_id`가 포함되면 좋겠습니다. 유저를 생성할 때 필수적으로 필요한 정보니까요. 그리고 url 경로가 바뀌었으면 좋겠습니다 다른 url 경로들에 포함되므로.

- `timestamp 반환 방식`  
  → timestamp 반환을 KST / UTC 중 무엇으로 할 지 정해야 합니다. 제가 이거 정해야 했었는데 까먹고 있었네요. 급하면 임의로 결정하시는 것도 괜찮은 방법일 듯 합니다. 

- `/api/users/me:GET`  
  → 회원 id를 받거나, session 값을 받아야 할 것 같습니다.  
  → 우선은 id를 받아 정보를 주는 방식으로 구현해주세요. (나중에 수정할 것)

- `/api/users/oauth-login`  
  → 프론트에서 NextAuth로 처리 예정이므로 필요 없습니다.

- `/api/admin/users/:id/status`  
  → 이미 body에서 status를 받고 있으므로 URL에 status가 있을 필요는 없습니다.  
  공통 개선: `/api/admin/users/:id` 단에서 body를 확인하고 status 필드가 있으면 그걸 업데이트 하고, ${다른값} 필드가 있으면 ${다른값}을 업데이트 하는 방식으로 사용하면 되겠습니다.

---

### API Requests General

- REST 방식으로 다음 **3가지 method만 사용**해주세요:  
  - `GET` → 정보 조회  
  - `POST` → 정보 생성 / 수정  
  - `DELETE` → 정보 삭제

> 특별한 이유가 없는 경우 저 셋만을 주로 사용합니다.  
> 호환성 이슈같은 이유로 대부분의 REST에서 저 셋만을 사용하는 것이 유리하기 때문입니다.  
> [Upbit Open API 참조 링크](https://docs.upbit.com/kr/reference/주문-가능-정보) 이건 Upbit OpenAPI 리퍼런스 문서인데, 여기서도 GET/POST/DELETE만을 사용하고 있습니다.

- admin 권한을 요구하는 기능은 `/api/admin` prefix를 사용하는 것이 적절합니다. 그리고 관리자 권한이 필요한 url의 경우 관리자 id(정확히는 세션이나 jwt)도 함께 받아야 합니다.

- `/api/users/me`  
  → 많은 기능을 담당하고 있는데, **기능별로 분리**되면 좋겠습니다.  
  → URL 하나가 하나의 기능만 수행하도록 구성해주세요.  
    - URL이 겹치면 어떤 fetch가 어떤 기능을 하는지 프론트 / 백 모두 헷갈리기 쉽습니다.  
    - 문서도 복잡해지기 쉽고 나중에 코드 읽는 것도 어려워질 수 있습니다.

- `/api/user` 라는 POST 요청  
  → 기능 명시적인 URL로 변경하는 것을 권장합니다. (`/api/user/generate`, `/api/user/create` 등)  
  → 추가적으로, 모든 기능을 가진 url이 다른 url에 포함되지 않는 것이 좋습니다. 어렵게 말해서, url 경로가 prefix-free이면 좋습니다. 어떤 url의 일부가 또다른 기능을 수행하면 헷갈리기 쉽기 때문.

---

## 논의 사항에 대한 의견

- **처리 안 하는 방향이 적절**  
  → 복전생과 부전생 모두 어쨌든 주전공이 존재하므로, 어쨌든 주전공을 입력하게 하면 해결됩니다.
  → 기능상으로도 복전생과 주전생이 사용할 수 있는 페이지가 크게 다르지 않으므로, 문제없을 것 같습니다.
  → 구체적 결정은 5월 12일 회의로 결정하면 되겠습니다.

- **전과**  
  → 이건 다전공이 아니므로 별도 처리 필요 없음  
  → 어차피 유저 DB의 key도 아니므로 **update 처리**로 충분

- **학부/대학원 모두 서울대인 경우**  
  → 대학원 기준으로 전공을 결정해야 하는지는 회의하여 결정하거나 또는 지훈님 의견이 필요합니다.  
  → 일단 대학원 학부가 엄청 다양한 걸로 알고 있었는데 잘 모르겠음.